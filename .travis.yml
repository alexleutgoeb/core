language: generic

matrix:
  include:
    - os: linux
      sudo: required
      dist: trusty
      env: BUILDTYPE=linux
    - os: linux
      sudo: required
      dist: trusty
      env: BUILDTYPE=windows
    - os: osx
      env: BUILDTYPE=osx

before_install:
  - ./scripts/check-${BUILDTYPE}.sh

script:
  - export PYTHON_BIN=python2.7
  - if [ $BUILDTYPE == linux ]; then ./bootstrap.sh; fi
  - if [ $BUILDTYPE == linux ]; then ./configure CXXFLAGS=-fPIC LOCAL_PLUGIN_DIR=plugins --enable-python --enable-shared=no --enable-static-boost; fi
  - if [ $BUILDTYPE == linux ]; then make; fi

after_failure:
  - if [ $BUILDTYPE == linux ]; then cat config.log; fi
